# Daubechies 5小波的数学原理详解

## 1. 小波基础理论

### 1.1 连续小波变换
连续小波变换的定义为：

$$W_f(a,b) = \frac{1}{\sqrt{a}} \int_{-\infty}^{\infty} f(t) \psi^*\left(\frac{t-b}{a}\right) dt$$

其中：
- $a$：尺度参数（缩放）
- $b$：平移参数
- $\psi(t)$：母小波函数
- $\psi^*(t)$：复共轭

### 1.2 二进小波变换
在离散情况下，使用二进离散化：

$$\psi_{j,k}(t) = 2^{-j/2} \psi(2^{-j}t - k)$$

其中：
- $j$：尺度级数
- $k$：平移位置

## 2. Daubechies 5小波构造

### 2.1 尺度函数与小波函数的关系

Daubechies小波通过尺度函数$\phi(t)$构造，满足双尺度方程：

$$\phi(t) = \sqrt{2} \sum_{n=0}^{2N-1} h_n \phi(2t - n)$$

对于db5，$N=5$，所以求和范围是$n=0$到$9$。

小波函数定义为：

$$\psi(t) = \sqrt{2} \sum_{n=0}^{2N-1} g_n \phi(2t - n)$$

其中：
$$g_n = (-1)^n h_{2N-1-n}$$

### 2.2 滤波器系数的数学推导

#### 2.2.1 消失矩条件
Daubechies 5小波具有5阶消失矩：

$$\int_{-\infty}^{\infty} t^p \psi(t) dt = 0, \quad p = 0,1,2,3,4$$

在频域中，这等价于：

$$\left.\frac{d^p}{d\omega^p} \hat{\psi}(\omega)\right|_{\omega=0} = 0, \quad p = 0,1,2,3,4$$

#### 2.2.2 正交性条件
尺度函数满足正交性：

$$\langle \phi(t), \phi(t-k) \rangle = \delta_{k,0}$$

转换为滤波器系数的条件：

$$\sum_{n=0}^{9} h_n h_{n-2k} = \delta_{k,0}$$

#### 2.2.3 归一化条件
$$\sum_{n=0}^{9} h_n = \sqrt{2}$$

#### 2.2.4 求解滤波器系数
通过上述约束条件，可以得到db5的精确滤波器系数：

**尺度滤波器 $h[n]$**（精确到小数点后16位）：
```
h[0] =  0.1601023979741929
h[1] =  0.6038292697971895
h[2] =  0.7243085284377726
h[3] =  0.1384281459013203
h[4] = -0.2422948870663823
h[5] = -0.0322448695846381
h[6] =  0.0775714938400459
h[7] = -0.0062414902127983
h[8] = -0.0125807519990820
h[9] =  0.0033357252850015
```

**小波滤波器 $g[n]$**：
```
g[0] =  0.0033357252850015
g[1] = -0.0125807519990820
g[2] = -0.0062414902127983
g[3] =  0.0775714938400459
g[4] = -0.0322448695846381
g[5] = -0.2422948870663823
g[6] =  0.1384281459013203
g[7] =  0.7243085284377726
g[8] =  0.6038292697971895
g[9] = -0.1601023979741929
```

## 3. 频域特性分析

### 3.1 频率响应函数
尺度函数和小波函数的傅里叶变换：

$$\hat{\phi}(\omega) = \frac{1}{\sqrt{2\pi}} \prod_{j=1}^{\infty} H\left(\frac{\omega}{2^j}\right)$$

$$\hat{\psi}(\omega) = \frac{1}{\sqrt{2\pi}} G\left(\frac{\omega}{2}\right) \prod_{j=2}^{\infty} H\left(\frac{\omega}{2^j}\right)$$

其中：
$$H(\omega) = \frac{1}{\sqrt{2}} \sum_{n=0}^{9} h_n e^{-i\omega n}$$
$$G(\omega) = \frac{1}{\sqrt{2}} \sum_{n=0}^{9} g_n e^{-i\omega n}$$

### 3.2 幅频响应
$$|H(\omega)| = \frac{1}{\sqrt{2}} \left|\sum_{n=0}^{9} h_n e^{-i\omega n}\right|$$

对于db5，幅频响应具有以下特性：
- 低通特性：在$\omega=0$处，$|H(0)| = 1$
- 半带特性：$|H(\pi)| = 0$
- 平滑过渡：在通带和阻带之间平滑过渡

### 3.3 相频响应
$$\arg H(\omega) = \arctan\left(\frac{\text{Im}[H(\omega)]}{\text{Re}[H(\omega)]}\right)$$

db5不具有严格的线性相位，但近似对称。

## 4. 时域特性

### 4.1 支撑区间
Daubechies 5小波的支撑区间为：
$$\text{supp}(\psi) = [0, 2N-1] = [0, 9]$$

这意味着小波函数只在区间$[0,9]$内非零。

### 4.2 能量集中性
小波函数的能量：
$$E_\psi = \int_{-\infty}^{\infty} |\psi(t)|^2 dt = 1$$

能量主要分布在支撑区间的中心部分。

## 5. 多分辨率分析

### 5.1 子空间分解
$L^2(\mathbb{R})$空间可以分解为一系列嵌套子空间：

$$\cdots \subset V_{-1} \subset V_0 \subset V_1 \subset \cdots$$

其中：
$$V_{j+1} = V_j \oplus W_j$$

$W_j$是$V_j$在$V_{j+1}$中的正交补空间。

### 5.2 分解与重构算法

#### 分解算法（Mallat算法）
$$c_{j,k} = \sum_{n} h_{n-2k} c_{j+1,n}$$
$$d_{j,k} = \sum_{n} g_{n-2k} c_{j+1,n}$$

其中：
- $c_{j,k}$：第$j$层的近似系数
- $d_{j,k}$：第$j$层的细节系数

#### 重构算法
$$c_{j+1,n} = \sum_{k} h_{n-2k} c_{j,k} + \sum_{k} g_{n-2k} d_{j,k}$$

## 6. 数值实现

### 6.1 离散小波变换实现
对于离散信号$x[n]$，$n=0,1,\ldots,N-1$：

#### 一层分解
$$c_1[k] = \sum_{n=0}^{9} h_n x[n-2k]$$
$$d_1[k] = \sum_{n=0}^{9} g_n x[n-2k]$$

#### 边界处理
使用对称扩展：
$$x[n] = x[-n-1], \quad n < 0$$
$$x[n] = x[2N-1-n], \quad n \geq N$$

### 6.2 计算复杂度
- 时间复杂度：$O(N)$
- 空间复杂度：$O(N)$
- 对于$N$点信号，总运算量约为$10N$次乘加运算

## 7. 在ECG处理中的应用

### 7.1 频率分割
对于360Hz采样的ECG信号，9层分解的频率分布：

$$f_j = \frac{f_s}{2^{j+2}}, \quad j=0,1,\ldots,8$$

其中$f_s = 360$Hz为采样率。

具体频率分布：
- 第1层：90-180 Hz（高频噪声）
- 第2层：45-90 Hz（高频噪声）
- 第3层：22.5-45 Hz（QRS高频成分）
- 第4层：11.25-22.5 Hz（QRS主要频率）
- 第5层：5.6-11.25 Hz（P波、T波）
- 第6层：2.8-5.6 Hz（P波、T波）
- 第7层：1.4-2.8 Hz（低频成分）
- 第8层：0.7-1.4 Hz（极低频）
- 第9层：0-0.7 Hz（基线漂移）

### 7.2 数学上的去噪原理

#### 7.2.1 阈值函数
软阈值函数：
$$T_{soft}(x,\lambda) = \text{sign}(x) \cdot \max(|x| - \lambda, 0)$$

硬阈值函数：
$$T_{hard}(x,\lambda) = \begin{cases}
x, & |x| > \lambda \\
0, & |x| \leq \lambda
\end{cases}$$

#### 7.2.2 阈值选择
Donoho-Johnstone通用阈值：
$$\lambda = \sigma \sqrt{2 \ln N}$$

其中噪声方差估计：
$$\sigma = \frac{\text{median}(|d_1|)}{0.6745}$$

#### 7.2.3 去噪的数学解释
设观测信号：
$$y = s + n$$

其中$s$是真实信号，$n$是加性噪声。

小波变换后：
$$W_y = W_s + W_n$$

通过阈值处理：
$$\hat{W}_s = T(W_y, \lambda)$$

反变换得到去噪信号：
$$\hat{s} = W^{-1}(\hat{W}_s)$$

### 7.3 误差分析
均方误差：
$$\text{MSE} = \frac{1}{N}\sum_{i=0}^{N-1} (\hat{s}[i] - s[i])^2$$

信噪比改善：
$$\Delta\text{SNR} = 10\log_{10}\left(\frac{\text{Var}(n)}{\text{Var}(y-\hat{s})}\right)$$

## 8. 总结

Daubechies 5小波的数学基础建立在多分辨率分析框架上，通过满足正交性、消失矩和紧支撑性等约束条件构造而成。其数学表达式体现了时频局部化的最优平衡，特别适合处理像ECG这样的生物医学信号。通过小波分解和阈值处理的数学过程，能够有效分离信号和噪声，实现高质量的去噪效果。